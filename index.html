<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="../dist/glur.js"></script>
<script src="./image-encoded.js"></script>
<script> // performance.now polyfill
(function () {
    if (window.performance && window.performance.now) return;
    if (!window.performance) window.performance = {};
    var methods = ['webkitNow', 'msNow', 'mozNow'];
    for (var i = 0; i < methods.length; i++) {
        if (window.performance[methods[i]]) {
            window.performance.now = window.performance[methods[i]];
            return;
        }
    }
    if (Date.now) {
        window.performance.now = function () {
            return Date.now();
        };
        return;
    }
    window.performance.now = function () {
        return +(new Date());
    };
})();
</script>


<style>
    #src {
        border: 5px solid #ddd;
        max-width: 500px;
    }

    #dst, #dst-cvs {
        border: 5px solid #ddd;
        max-width: 500px;
    }
</style>


<p>
    Original (<span id="src-info"></span>):<br>
    <canvas id='src'></canvas>
</p>

<p>
    Blurred (<span id="dst-info"></span>):<br>
    <canvas id='dst'></canvas>
</p>

<script>
    var img = new Image();

    img.src = imageEncoded;

    img.onload = function () {
        var src, dst, ctx, start;

        // Draw original

        src = $('#src')[0];
        src.width = img.width;
        src.height = img.height;

        $('#src-info').text('' + img.width + ' x ' + img.height);

        ctx = src.getContext("2d");
        ctx.drawImage(img, 0, 0);

        dst = $('#dst')[0];
        dst.width = img.width;
        dst.height = img.height;

        ctx = dst.getContext("2d");
        ctx.drawImage(img, 0, 0);

        start = performance.now();

        window.glur.blurCanvas(dst, 1, function (err) {
            $('#dst-info').text((performance.now() - start).toFixed(2) + 'ms');
        });
    };
</script>